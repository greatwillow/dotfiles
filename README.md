# dotfiles
My personal home configurations

## Usage

1. To make updates to the system after modifying a flake:
   
```bash
% cd ./nix-darwin 
% darwin-rebuild switch --flake .
```

2. If needing to debug the flake, add NIX_DEBUG=1. Note that running the following command without the `switch` statement will terminate the execution.  This is useful for debugging purposes.

```bash
% cd ./nix-darwin 
% NIX_DEBUG=1 darwin-rebuild switch --flake .
```

## Nix Package Location

Nix places packages in `/nix/store` and links to those on a per user basis inside of ` /etc/profiles/per-user/$USER/` where $USER may be `myUserName`.  When things are set up properly, the `~/.nix-profile` file is symlinked to this folder.  It was once observed that this had changed and was no longer the case.  In such a case, the following commands need to be run:

1. `rm ~/.nix-profile`
2. `ln -s /etc/profiles/per-user/$USER/ ~/.nix-profile`

and then the path `~/.nix-profile/bin` needs to be added to `$PATH`

## System Names

- **artemis** - The local macbook pro
- **apollo** - The work computer

## Usage of Configured Libraries

### Nushell

**Issues** 
There was an issue with starting nushell where it does not point by default to the config file located at `~/.config/nushell/config.nu`.  To resolve this, it is necessary to start nushell with the command `nu --config ~/.config/nushell/config.nu` rather than the standard `nu` command.  This is the way that nushell is being started from within ITerm2.  See [this](https://github.com/nushell/nushell/discussions/5279) thread for more context.

### Oh My Posh

**Theming**
For OMP themes, go [here](https://ohmyposh.dev/docs/themes)

**Issues**
OMP is initialized in the bottom of the `env.nu` file with the following script:

`oh-my-posh init nu --config ~/.config/oh-my-posh/themes/catppuccin_mocha.omp.json --print | save ~/oh-my-posh-init.nu --force`

Here, OMP is taking the catpuccin_mocha theme config and saving it with an autogenerated initialization script `oh-my-posh-init.nu`.  In this special case, we are accessing this file from the user root directory instead of the `.config` directory.  This is because there were some issue with OMP writing to the `.config` directory.  

**Manual Steps**
An important note here is that the `~/oh-my-posh-init.nu` file must be created manually to allow this file to be written to.  This is because there were issues making this work in nushell.  Note also that the terminal may need to be opened twice initially before the initial config takes effect.
Also, note that the Nix installed Nerd Font may need to be set up to be used in the given terminal emulator to allow for OMP to work properly. 

### NeoVim

**Manual Steps**
The folder `/Users/gdenys/.local/share/nvim` needs to be manually created for nvim to work.  Currently the activation script inside `home.nix` is not working to create this automatically.
